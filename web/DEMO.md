# 🎬 功能演示指南

## 快速体验所有新功能

### 准备工作

**终端 1** - 启动 Service：
```bash
cd /Users/shangui/Desktop/project/litenmcp
pnpm run service
```

**浏览器** - 访问：
```
http://localhost:3000
```

---

## 🎯 演示 1：Session 持久化

### 步骤

1. **首次连接**
   ```
   服务器：ws://localhost:9000
   用户名：Alice
   点击"连接"
   ```

2. **加入房间**
   ```
   点击左侧的 "#general"
   ```

3. **发送几条消息**
   ```
   输入："测试消息 1"
   输入："测试消息 2"
   ```

4. **刷新页面**
   ```
   按 F5 或 Cmd/Ctrl + R
   ```

5. **✨ 看到魔法发生！**
   - ✅ 自动重连到服务器
   - ✅ 自动加入 general 房间
   - ✅ 消息历史自动加载
   - ✅ 无需任何操作！

### 验证点

**浏览器控制台**（F12）：
```
🔍 Checking for saved session...
📂 Session loaded: {serverUrl: "ws://localhost:9000", username: "Alice"}
🔄 Auto-reconnecting from saved session...
✅ WebSocket connected successfully
🔐 Authenticated! Fetching rooms and users...
🔄 Auto-joining last room: general
✅ Joined room: general
```

**UI 显示**：
- 左上角显示用户名：Alice
- 当前房间高亮：general
- 连接徽章：绿色 🟢

---

## 🎯 演示 2：心跳机制

### 步骤

1. **连接到服务器**

2. **打开调试面板**
   ```
   点击右下角的终端图标 🖥️
   ```

3. **等待 30 秒**
   ```
   看到第一个心跳
   ```

4. **继续等待**
   ```
   每 30 秒看到一次 💓
   ```

### 验证点

**调试面板日志**：
```
10:30:00 [info] 💗 Starting heartbeat (30s interval)
10:30:30 [info] 💓 Heartbeat sent
10:31:00 [info] 💓 Heartbeat sent
10:31:30 [info] 💓 Heartbeat sent
...
```

**浏览器控制台**：
```
💗 Starting heartbeat (30s interval)
💓 Heartbeat sent
💓 Heartbeat sent
...
```

### 长时间测试

```
1. 连接到服务器
2. 挂机 1 小时
3. ✅ 连接保持稳定
4. ✅ 没有出现 1006 错误
5. ✅ 可以继续发送消息
```

---

## 🎯 演示 3：自动重连

### 步骤

1. **连接到本地服务器**
   ```
   ws://localhost:9000
   ```

2. **加入房间并聊天**

3. **停止 Service**
   ```
   在 Service 终端按 Ctrl+C
   ```

4. **✨ 观察自动重连**
   - 看到黄色提示框
   - 倒计时显示
   - 进度条动画

5. **重新启动 Service**
   ```bash
   pnpm run service
   ```

6. **✅ 自动重连成功！**
   - 连接恢复
   - 继续使用

### 验证点

**UI 提示**：
```
┌─────────────────────────────┐
│ 🔄 正在重连                 │
│ 连接断开，1秒后重连...      │
│ （第 1 次尝试）             │
│ [========进度条========]    │
└─────────────────────────────┘
```

**调试面板**：
```
10:35:00 [info] 🔌 WebSocket disconnected
10:35:00 [info] Close code: 1006
10:35:00 [info] 说明: 异常关闭（无法连接或连接中断）
10:35:01 [info] 🔄 Attempting reconnect (1/5) in 1000ms...
10:35:02 [info] 🔄 Reconnecting...
10:35:02 [info] ✅ WebSocket connected successfully
```

---

## 🎯 演示 4：完整流程

### 完美的用户旅程

```
Day 1, 10:00 AM
┌─────────────────────────────┐
│ 1. 首次使用                 │
│    - 输入服务器地址          │
│    - 输入用户名              │
│    - 点击连接 ✅             │
│    - 自动保存 session        │
└─────────────────────────────┘

Day 1, 10:05 AM
┌─────────────────────────────┐
│ 2. 加入房间                 │
│    - 选择 general           │
│    - 开始聊天 ✅             │
│    - 自动保存房间            │
└─────────────────────────────┘

Day 1, 10:15 AM
┌─────────────────────────────┐
│ 3. 不小心刷新页面 (F5)      │
│    - 页面重新加载            │
│    - 自动检测 session        │
│    - 自动重连 ✅             │
│    - 自动加入 general ✅     │
│    - 继续聊天，无缝体验！    │
└─────────────────────────────┘

Day 1, 11:00 AM
┌─────────────────────────────┐
│ 4. 长时间挂机                │
│    - 心跳每 30 秒发送 💓     │
│    - 连接保持活跃 ✅         │
│    - 没有超时断开            │
└─────────────────────────────┘

Day 1, 2:00 PM
┌─────────────────────────────┐
│ 5. WiFi 切换                │
│    - 连接短暂断开            │
│    - 1 秒后自动重连 ✅       │
│    - 继续聊天                │
└─────────────────────────────┘

Day 1, 6:00 PM
┌─────────────────────────────┐
│ 6. 下班离开                 │
│    - 点击"断开连接"          │
│    - Session 清除 ✅         │
└─────────────────────────────┘

Day 2, 9:00 AM
┌─────────────────────────────┐
│ 7. 第二天回来                │
│    - Session 已过期（24h内） │
│    - 看到 [📜 恢复会话]      │
│    - 信息已预填充 ✅         │
│    - 点击连接即可恢复        │
└─────────────────────────────┘
```

---

## 🎨 UI 元素演示

### 连接表单

```
┌───────────────────────────────────┐
│  连接到 AgentRoom    [📜 恢复会话] │
│  输入 WebSocket/SSE 服务器地址     │
├───────────────────────────────────┤
│  服务器地址                        │
│  [ws://localhost:9000]  ⚠️ 错误时  │
│  [本地] [公共服务器] ← 快捷按钮   │
│                                   │
│  用户名                            │
│  [Alice]                          │
│                                   │
│  [🌐 连接] [🔍 诊断]              │
│                                   │
│  ✓ Session 持久化                 │
│  ✓ 自动重连                       │
└───────────────────────────────────┘
```

### 聊天界面

```
┌────────┬──────────────────────┬────────┐
│ 房间   │    #general          │ 成员   │
│        │    General           │        │
│ 🟢 在线 │    [🔄] [👋 离开]    │ Alice  │
├────────┼──────────────────────┤ Bob    │
│        │  Alice  10:30        │ Carol  │
│刷新 创建│  你好                │        │
│        │                      │        │
│general │  Bob    10:31        │ 3 人   │
│random  │  嗨                  │        │
│        │                      │        │
│        │  [输入消息...] [📤]  │        │
├────────┴──────────────────────┴────────┤
│ 🟡 正在重连                            │
│ 连接断开，1秒后重连...（第 1 次尝试） │
│ [========进度条========]               │
└────────────────────────────────────────┘
```

### 调试面板（右下角）

```
┌────────────────────────────┐
│ 调试面板     [📋] [🗑️] [❌] │
│ WebSocket 连接日志         │
├────────────────────────────┤
│ 10:30:00 [info] ✅ 连接成功 │
│ 10:30:00 [info] 💗 启动心跳 │
│ 10:30:30 [info] 💓 心跳发送 │
│ 10:31:00 [info] 💓 心跳发送 │
│ 10:35:00 [error] 🔌 断开连接│
│ 10:35:01 [info] 🔄 重连中... │
│ 10:35:02 [info] ✅ 重连成功 │
└────────────────────────────┘
```

---

## 🎓 教程视频脚本

### 视频 1：基础使用（2 分钟）

```
0:00 - 打开 http://localhost:3000
0:10 - 输入服务器地址
0:15 - 输入用户名
0:20 - 点击连接（看到动画效果）
0:25 - 连接成功，看到房间列表
0:30 - 点击 general 房间
0:35 - 发送第一条消息
0:40 - 查看右侧成员列表
0:50 - 创建新房间
1:00 - 切换房间
1:10 - 离开房间
1:20 - 断开连接
```

### 视频 2：高级功能（3 分钟）

```
0:00 - 连接并加入房间
0:20 - 打开调试面板（右下角）
0:30 - 等待心跳消息（30秒）
1:00 - 看到 💓 心跳发送
1:10 - 按 F5 刷新页面
1:15 - 看到自动重连过程
1:20 - 自动加入上次房间
1:30 - 停止 Service 测试重连
1:40 - 看到黄色重连提示
1:50 - 重启 Service
2:00 - 看到自动重连成功
2:10 - 使用诊断工具
2:30 - 查看 localStorage 数据
2:50 - 总结
```

---

## 🎁 彩蛋功能

### 1. 键盘快捷键
- **Enter** - 发送消息（已实现）
- **Cmd/Ctrl + R** - 刷新页面（自动重连）

### 2. 隐藏功能
- 右下角调试面板
- 连接表单的诊断工具
- Session 恢复提示

### 3. 开发者工具
- 浏览器控制台完整日志
- localStorage 数据查看
- WebSocket 消息追踪

---

## 📸 截图清单

建议截图位置：

1. **连接表单** - 显示 Session 恢复提示
2. **房间列表** - 显示多个房间和成员数
3. **聊天界面** - 显示消息流
4. **重连提示** - 显示黄色重连框
5. **调试面板** - 显示心跳日志
6. **诊断工具** - 显示测试结果

---

## 🎉 最终测试清单

### ✅ 功能测试

- [ ] 连接本地服务器
- [ ] 连接公共服务器
- [ ] 创建房间
- [ ] 加入房间
- [ ] 发送消息
- [ ] 接收消息
- [ ] 查看成员列表
- [ ] 离开房间
- [ ] 断开连接

### ✅ Session 测试

- [ ] 连接后刷新页面（F5）
- [ ] 自动重连成功
- [ ] 自动加入上次房间
- [ ] 关闭标签页后 1 分钟内再打开
- [ ] 看到预填充信息

### ✅ 心跳测试

- [ ] 打开调试面板
- [ ] 等待 30 秒看到心跳
- [ ] 继续等待，验证持续发送
- [ ] 挂机 10 分钟，连接稳定

### ✅ 重连测试

- [ ] 停止 Service
- [ ] 看到重连提示
- [ ] 重启 Service
- [ ] 验证自动重连
- [ ] 测试 5 次重连后停止

### ✅ UI/UX 测试

- [ ] 悬停所有按钮看动画
- [ ] 点击按钮看反馈
- [ ] 聚焦输入框看效果
- [ ] 选择房间看高亮
- [ ] 测试快捷连接按钮

### ✅ 调试工具测试

- [ ] 打开调试面板
- [ ] 查看实时日志
- [ ] 复制日志
- [ ] 清空日志
- [ ] 关闭面板
- [ ] 使用诊断工具

---

## 🎊 演示完成

所有功能都已实现并可以正常使用！

**现在就去试试吧！** 🚀

1. 刷新浏览器：http://localhost:3000
2. 连接到服务器
3. 体验所有新功能
4. 打开调试面板查看心跳
5. 刷新页面测试 Session 恢复
6. 停止 Service 测试自动重连

---

**AgentRoom Web Client - 功能完整，体验流畅！** ✨
