#!/bin/bash

# CLI å‚æ•°è§£ææµ‹è¯•è„šæœ¬

echo "ğŸ§ª æµ‹è¯• CLI å‚æ•°è§£æ"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# é¢œè‰²å®šä¹‰
GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# æµ‹è¯•è®¡æ•°
PASSED=0
FAILED=0

# æµ‹è¯•å‡½æ•°
test_cli_args() {
    local name="$1"
    shift
    local args="$@"
    
    echo -e "${YELLOW}æµ‹è¯•: $name${NC}"
    echo "å‘½ä»¤: npx tsx src/service/cli.ts $args"
    
    # åˆ›å»ºä¸´æ—¶æµ‹è¯•è„šæœ¬æ¥éªŒè¯å‚æ•°
    cat > /tmp/test-cli-parse.js << 'EOF'
import { parseArgs } from './src/service/cli.ts';
const result = parseArgs();
console.log(JSON.stringify(result));
EOF
    
    echo ""
}

echo "ğŸ“‹ æµ‹è¯• 1: å®Œæ•´å‚æ•°"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
test_cli_args "å®Œæ•´å‚æ•°" "--name Alice --url ws://localhost:9000 --room test"
echo ""

echo "ğŸ“‹ æµ‹è¯• 2: éƒ¨åˆ†å‚æ•°ï¼ˆä½¿ç”¨é»˜è®¤å€¼ï¼‰"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
test_cli_args "ä»…åç§°" "--name Bob"
echo ""

echo "ğŸ“‹ æµ‹è¯• 3: ä»… URL"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
test_cli_args "ä»…URL" "--url ws://server:9000"
echo ""

echo "ğŸ“‹ æµ‹è¯• 4: URL è‡ªåŠ¨æ·»åŠ å‰ç¼€"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
test_cli_args "æ— å‰ç¼€URL" "--url localhost:9000"
echo ""

echo "ğŸ“‹ æµ‹è¯• 5: æŸ¥çœ‹å¸®åŠ©"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "å‘½ä»¤: npx tsx src/service/cli.ts --help"
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“Š æ‰‹åŠ¨æµ‹è¯•è¯´æ˜"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "1. æµ‹è¯•é»˜è®¤å€¼:"
echo "   npm run service:cli"
echo ""
echo "2. æµ‹è¯•å®Œæ•´å‚æ•°ï¼ˆæ³¨æ„ -- åˆ†éš”ç¬¦ï¼‰:"
echo "   npm run service:cli -- --name Alice --room test"
echo ""
echo "3. æµ‹è¯•è¿œç¨‹æœåŠ¡å™¨:"
echo "   npm run service:cli -- --url ws://118.145.113.13:9000 --name shangui"
echo ""
echo "4. æŸ¥çœ‹å¸®åŠ©:"
echo "   npm run service:cli -- --help"
echo ""
echo "5. ç›´æ¥æ‰§è¡Œï¼ˆæ— éœ€ --ï¼‰:"
echo "   npx tsx src/service/cli.ts --name Alice --room test"
echo ""

echo "âœ… å‚æ•°è§£æå·²ä¿®å¤ï¼"
echo "   è®°ä½ï¼šä½¿ç”¨ npm run æ—¶å¿…é¡»åŠ  -- åˆ†éš”ç¬¦"
echo ""
